# 1장 단위 테스트 목표

> **단위 테스트를 배는 것은 테스트 프레임워크나 목 라이브러리 등과 같은 기술적인 부분을 익히는 것에 그치지 않는다.**

> **테스트에 드는 노력을 가능한 줄이고 그에 따르는 이득을 최대화해야 한다.**

## 1.1 단위 테스트 현황

> **그냥 쓰고 버리는 프로젝트가 아니면, 단위 테스트는 늘 적용해야 한다.**

오늘 짠 코드를 나중에 봤을때, 알아보기 힘든 경우가 있는 만큼, 단위 테스트는 적용하는게 좋아보인다


> **`단위 테스트를 작성해야 하는가?`에서 `좋은 단위 테스트를 작성하는 것은 어떤 의미인가?`**

`좋은` 단위 테스트는 어디부터 좋다고 해야할까?

## 1.2 단위 테스트 목표

> 코드베이스에 대해 단위 테스트 작성이 필요하면 일번적으로 더 나은 설계로 이어진다.
>
> 코드 조각을 단위 테스트하는 것은 훌륭한 리트머스 시험이지만, 한 방향으로만 동작한다. 이는 괜찮은 부정 지표다.
> 
> 안타깝게도 코드 조각을 단위 테스트할 수 있다는 것은 좋지 않은 긍정 지표다.
> 
> 코드베이스를 쉽게 단위 테스트할 수 있다고 해도 반드시 코드 품질이 좋은 것을 의미하지는 않는다.


**단위 테스트의 목표는 소프트웨어 프로젝트의 지속 가능한 성장을 가능하게 하는 것이다.**

단위 테스트의 단점으로는 초반에 노력이 필요하다는 것.

다만, 코드베이스를 지속적으로 검증하는 테스트 없이는 소프트웨어 개발이 쉽게 확장되지 않는다.

**지속성과 확장성이 핵심이며, 이를 통해 장기적으로 개발 속도를 유지할 수 있다.**

### 1.2.1 좋은 테스트와 좋지 않는 테스트를 가르는 요인

> **모든 테스트를 작성할 필요는 없다**
> 
> 일부 테스트는 아주 중요하고 품질에 많은 기여를 하지만
> 
> 잘못된 경고가 발생하고, 회귀 오류를 알아내는데 도움이 되지 않으며, 유지 보수가 어렵고 느리다.

회귀 오류란?

코드 수정후 버그가 발생하나 테스트가 통과하는 상태라고 보면 된다

좋은 테스트를 만드는 습관

- 기반 코드를 리팩토링할 때 테스트 코드도 같이 리팩토링
- 각 코드 변경시 테스트를 실행
- 테스트가 잘못된 경고를 발생시킬 경우 처리
- 기반 코드가 어떻게 동작하는지 이해하려고 할 때는 테스트를 읽는 데 시간을 투자

> **테스트 코드도 역시 코드다.**
> 
> 테스트 코드도 버그에 취약하고 유지보수가 필요하다.

## 1.3 테스트 스위트 품질 측정을 위한 커버리지 지표

가장 널리 사용되는 커버리지 지표

1. 코드 커버리지
2. 분기 커버리지

> **커버리지 지표는 중요한 피드백을 주더라도 테스트 스위트 품질을 효과적으로 측정하는 데 사용될 수 없다.**
> 
> 100% 커버리지라고 해서 반드시 양질의 테스트 스위트라고 보장하지는 않는다.

### 1.3.3 커버리지 지표에 관한 문제점

테스트 스위트의 품질을 결정하는 데 어떤 커버리지 지표도 의존할 수 없는 이유

- 테스트 대상 시스템의 모든 가능한 결과를 검증한다고 보장할 수 없다.
- 외부 라이브러리의 코드 경로를 고려할 수 있는 커버리지 지표는 없다.

### 1.3.4 특정 커버리지 숫자를 목표로 하기

> **100%, 90%, 심지어 중간 정도인 70%까지 특정 커버리지 숫자를 목표로 삼기 시작하면 위험 영역으로 이어질 수 있다.**
> 
> 커버리지 지표를 가장 좋은 방법은 지표 그 자체로 보는 것이며, 목표로 여겨서는 안된다.

## 1.4 무엇이 성공적인 테스트 스위트를 만드는가?

성공적인 스위트의 특성

- 개발 주기에 통합되어 있다.
  - 코드가 변경될때마다 아무리 작은 내용이라도 실행이 되어야 한다.
- 코드베이스에서 가장 중요한 부분만을 대상으로 한다.
  - 시스템의 중요 부분에 테스트 노력을 기울이고, 다른 부분은 간략하게 또는 간접적으로 검증하는 것이 좋다.
  - 초점은 도메인 모델에 머물러야 한다.
- 최소한의 유지비로 최대의 가치를 끌어낸다.
  - 단위 테스트에 중점을 뒀지만, 코드 설계에 많은 부분을 할애해야 한다.
